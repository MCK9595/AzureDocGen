# Azure インフラ詳細設計書作成ツール 実装ToDoリスト

このドキュメントは実装タスクの進捗管理用です。完了したタスクは `[x]` にチェックを入れてください。

## 📋 全体進捗サマリー
- Phase 1: コア機能基盤 `[----------] 0%`
- Phase 2: ビジュアル設計機能 `[----------] 0%`
- Phase 3: ワークフロー・出力機能 `[----------] 0%`
- Phase 4: 管理・運用機能 `[----------] 0%`

---

## Phase 1: コア機能基盤（2-3週間）

### 1.1 プロジェクト・環境管理

#### コントローラー実装
- [x] `ProjectController.cs` の作成
  - [x] Index（一覧表示）アクション
  - [x] Details（詳細表示）アクション
  - [x] Create（作成）アクション
  - [x] Edit（編集）アクション
  - [x] Delete（削除）アクション
  - [x] 権限チェックの実装
- [ ] `EnvironmentController.cs` の作成
  - [ ] 環境CRUD操作
  - [ ] プロジェクトとの関連付け

#### サービス層実装
- [x] `IProjectService.cs` インターフェース定義
- [x] `ProjectService.cs` 実装
  - [x] CreateProjectAsync
  - [x] GetProjectByIdAsync
  - [x] GetUserProjectsAsync
  - [x] UpdateProjectAsync
  - [x] DeleteProjectAsync
  - [x] AddProjectMemberAsync
  - [x] RemoveProjectMemberAsync
- [ ] `IEnvironmentService.cs` インターフェース定義
- [ ] `EnvironmentService.cs` 実装

#### Blazorコンポーネント作成（MVCビューで実装）
- [x] `ProjectListPage.razor` → `Views/Project/Index.cshtml`
  - [x] プロジェクト一覧表示
  - [ ] 検索・フィルター機能
  - [ ] ページネーション
  - [x] 新規作成ボタン
- [x] `ProjectDetailsPage.razor` → `Views/Project/Details.cshtml`
  - [x] プロジェクト情報表示
  - [x] 環境一覧
  - [x] メンバー一覧
  - [x] 編集・削除ボタン
- [x] `ProjectCreateEditModal.razor` → `Views/Project/Create.cshtml` & `Edit.cshtml`
  - [x] プロジェクト作成フォーム
  - [x] バリデーション
  - [x] 送信処理
- [ ] `EnvironmentManager.razor`
  - [ ] 環境追加・編集・削除
  - [ ] 環境別設定
- [ ] `ProjectMemberManager.razor`
  - [ ] メンバー追加
  - [ ] 権限設定
  - [ ] メンバー削除

#### ルーティング・ナビゲーション
- [x] プロジェクト関連ページのルート設定
- [x] NavMenuへのプロジェクトリンク追加
- [x] パンくずナビゲーション実装
- [x] テンプレート関連ページのルート設定
- [x] NavMenuへのテンプレートリンク追加

### 1.2 テンプレート管理

#### コントローラー実装
- [x] `TemplateController.cs` の作成
  - [x] テンプレートCRUD操作
  - [x] バージョン管理機能
  - [x] 共有設定機能

#### サービス層実装
- [x] `ITemplateService.cs` インターフェース定義
- [x] `TemplateService.cs` 実装
  - [x] CreateTemplateAsync
  - [x] GetTemplateByIdAsync
  - [x] UpdateTemplateAsync
  - [x] CreateVersionAsync
  - [x] GetTemplateVersionsAsync
  - [x] DuplicateTemplateAsync
  - [x] AddParameterAsync
  - [x] DeleteParameterAsync

#### MVC ビュー作成（MVCビューで実装）
- [x] `Views/Template/Index.cshtml`
  - [x] テンプレート一覧
  - [x] カテゴリー別表示
  - [x] 共有レベルフィルター
  - [ ] 検索機能
  - [ ] ページネーション
- [x] `Views/Template/Details.cshtml`
  - [x] テンプレート情報表示
  - [x] パラメーター管理
  - [x] バージョン履歴表示
  - [x] バージョン作成・複製機能
- [x] `Views/Template/Create.cshtml` & `Edit.cshtml`
  - [x] テンプレート作成・編集フォーム
  - [x] バリデーション
  - [x] 共有レベル設定

#### データ検証
- [ ] テンプレート構造のバリデーション
- [ ] パラメーター定義の整合性チェック
- [ ] 循環参照チェック

---

## Phase 2: ビジュアル設計機能（4-6週間）

### 2.1 ビジュアルデザイナー基盤

#### JavaScript/CSS統合
- [ ] SVG.js または Fabric.js の選定・統合
- [ ] カスタムCSSスタイルシート作成
- [ ] JavaScript Interopラッパー作成

#### コンポーネント開発
- [ ] `VisualDesigner.razor`
  - [ ] メインコンテナ実装
  - [ ] ツールバー実装
  - [ ] ステータスバー実装
- [ ] `ResourcePalette.razor`
  - [ ] Azureリソースカテゴリー表示
  - [ ] ドラッグ可能アイテム実装
  - [ ] 検索機能
- [ ] `DesignCanvas.razor`
  - [ ] SVGキャンバス初期化
  - [ ] グリッド表示
  - [ ] ズーム・パン機能
- [ ] `PropertyPanel.razor`
  - [ ] 動的プロパティ表示
  - [ ] インライン編集
  - [ ] 変更の即時反映

### 2.2 インタラクティブ機能

#### ドラッグ&ドロップ
- [ ] ドラッグ開始イベント処理
- [ ] ドロップゾーン検証
- [ ] リソース配置処理
- [ ] 位置の永続化

#### リソース操作
- [ ] リソース選択機能
- [ ] 複数選択サポート
- [ ] 移動・リサイズ機能
- [ ] 削除機能
- [ ] コピー&ペースト

#### 接続機能
- [ ] 接続ポイント定義
- [ ] 接続線描画
- [ ] 接続バリデーション
- [ ] 接続情報の保存

### 2.3 高度な機能

#### 自動配置
- [ ] 配置アルゴリズム実装
- [ ] 整列機能
- [ ] 配布機能
- [ ] グループ化

#### エクスポート
- [ ] SVGエクスポート
- [ ] PNG/JPEGエクスポート
- [ ] Visio形式対応検討

---

## Phase 3: ワークフロー・出力機能（3-4週間）

### 3.1 レビューワークフロー UI

#### ワークフロー管理
- [ ] `WorkflowDashboard.razor`
  - [ ] 進行中のワークフロー一覧
  - [ ] ステータス別フィルター
  - [ ] 期限管理
- [ ] `ReviewInterface.razor`
  - [ ] レビュー対象表示
  - [ ] コメント機能
  - [ ] 承認・差し戻しボタン
- [ ] `ApprovalHistory.razor`
  - [ ] 承認履歴タイムライン
  - [ ] コメント履歴
  - [ ] 状態遷移ログ

#### 通知機能
- [ ] アプリ内通知システム
- [ ] 通知アイコン・バッジ
- [ ] 通知設定管理

### 3.2 出力機能

#### Excel出力
- [ ] ClosedXML統合
- [ ] テンプレート定義
- [ ] データマッピング
- [ ] スタイル設定
- [ ] 構成図挿入

#### PDF出力
- [ ] iTextSharp統合
- [ ] レイアウト設計
- [ ] ヘッダー・フッター
- [ ] 目次自動生成
- [ ] 構成図埋め込み

#### Markdown出力
- [ ] Markdownジェネレーター実装
- [ ] テーブル生成
- [ ] 画像リンク処理
- [ ] メタデータ付与

#### 共通機能
- [ ] 環境選択UI
- [ ] 機密情報マスク機能
- [ ] 出力プレビュー
- [ ] バッチ出力

---

## Phase 4: 管理・運用機能（2-3週間）

### 4.1 命名規則管理

#### エディター実装
- [ ] `NamingRuleEditor.razor`
  - [ ] パターン定義UI
  - [ ] 変数定義
  - [ ] プレビュー機能
- [ ] `NamingRuleService.cs`
  - [ ] ルール評価エンジン
  - [ ] 自動命名生成
  - [ ] 重複チェック

### 4.2 監査・履歴管理

#### ビューアー実装
- [ ] `AuditLogViewer.razor`
  - [ ] ログ検索・フィルター
  - [ ] 期間指定
  - [ ] エクスポート機能
- [ ] `HistoryTimeline.razor`
  - [ ] 変更履歴表示
  - [ ] 差分表示
  - [ ] ロールバック機能

### 4.3 データ管理

#### エクスポート・インポート
- [ ] プロジェクトエクスポート機能
- [ ] データインポート機能
- [ ] マイグレーションツール

#### アーカイブ
- [ ] アーカイブ機能実装
- [ ] アーカイブ管理UI
- [ ] 復元機能

---

## 🧪 テスト実装

### 単体テスト
- [ ] サービス層テスト（各サービスクラス）
- [ ] コントローラーテスト
- [ ] ユーティリティテスト
- [ ] バリデーションテスト

### 統合テスト
- [ ] API統合テスト
- [ ] データベース統合テスト
- [ ] 認証・認可テスト
- [ ] ワークフローテスト

### E2Eテスト
- [ ] 主要ユーザーシナリオ
- [ ] ビジュアルデザイナー操作
- [ ] 出力機能テスト

---

## 📝 ドキュメント作成

### 技術ドキュメント
- [ ] API仕様書
- [ ] データベース設計書
- [ ] アーキテクチャ図更新

### ユーザードキュメント
- [ ] ユーザーマニュアル
- [ ] 管理者ガイド
- [ ] トラブルシューティングガイド

### 開発ドキュメント
- [ ] セットアップガイド
- [ ] 開発規約
- [ ] デプロイメント手順

---

## 完了基準

各フェーズの完了基準：

### Phase 1 完了基準
- [ ] プロジェクトの作成・編集・削除が可能
- [ ] 環境の管理が可能
- [ ] テンプレートの作成・バージョン管理が可能
- [ ] 権限に基づくアクセス制御が機能

### Phase 2 完了基準
- [ ] ビジュアルデザイナーでリソース配置が可能
- [ ] リソース間の接続設定が可能
- [ ] 設計内容の保存・読み込みが可能
- [ ] 構成図のエクスポートが可能

### Phase 3 完了基準
- [ ] レビューワークフローが機能
- [ ] Excel/PDF/Markdown形式での出力が可能
- [ ] 機密情報のマスクが機能
- [ ] 複数環境の一括出力が可能

### Phase 4 完了基準
- [ ] 命名規則の定義・適用が可能
- [ ] 監査ログの検索・出力が可能
- [ ] データのエクスポート・インポートが可能
- [ ] すべての機能が統合され正常動作

---

最終更新日: 2025-01-07